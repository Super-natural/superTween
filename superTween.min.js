/*
 * Super natural's Tween Engine
 * http://www.wearesupernatural.com/
 * Based on Robert Penners Easing functions
 * v0.1.0, last commit 27/02/15
 * currently supports down to IE8
 */

var App = App || {};
	App.superTween = App.superTween || {};
	
var easeGlobals = {
  	updateRate: 30,
  	loopTimer: null,
  	availAttr: ['opacity', 'x', 'y', 'scaleY', 'scaleX']
}
var curAnims = [];



/* @param elem: element to be tweened
 * @param time: length of animation
 * @param obj{
 *	 		delay: Dime to delay (in seconds)
 *			onComplete: Function to run after animation completion
 *			onCompleteParams: parameters for the oncomplete function
 *			ease: ease to use for tween
*/
function tweenLoop(){for(i=0;i<curAnims.length;i++)if(curAnims[i].curDel)curAnims[i].curDelStep++,curAnims[i].curDelStep>curAnims[i].delaySteps&&(curAnims[i].curDel=!1);else{for(var a=0;a<curAnims[i].attr.length;a++){var b={curStep:curAnims[i].curStep,animSteps:curAnims[i].animSteps,origin:curAnims[i].attr[a].origin,targVal:curAnims[i].attr[a].targVal},c=curAnims[i].ease(b);setPos(curAnims[i].elem,curAnims[i].attr[a],c)}if(curAnims[i].curStep++,curAnims[i].curStep>curAnims[i].animSteps){if(curAnims[i].onComplete)var d=curAnims[i].onComplete,e=curAnims[i].onCompleteParams;curAnims.splice(i,1),d&&d.apply(this,e)}}0!=curAnims.length?easeGlobals.loopTimer=setTimeout(tweenLoop,easeGlobals.updateRate):(clearTimeout(easeGlobals.loopTimer),easeGlobals.loopTimer=null)}function setupTween(a,b,c){c.ease||(c.ease=Sine.easeInOut);var d={attr:getAttr(a,c),animSteps:Math.floor(b/easeGlobals.updateRate),delaySteps:Math.floor(c.delay/easeGlobals.updateRate),curDel:!1,curStep:0,curDelStep:0,elem:a,ease:c.ease,onComplete:c.onComplete,onCompleteParams:c.onCompleteParams};return d.delaySteps>0&&(d.curDel=!0),d}function getAttr(a,b){for(var c=[],d=0;d<easeGlobals.availAttr.length;d++){var e=easeGlobals.availAttr[d];if(null!==b[e]&&void 0!==b[e]){var f={};f.attr=easeGlobals.availAttr[d],f.origin=getPos(a,f.attr,b[f.attr]),f.targVal=getTarg(f.attr,b[f.attr],f.origin,a),c.push(f)}}return c}function getPos(a,b,c){switch(b){case"x":return a.offsetLeft;case"y":return a.offsetTop;case"scaleX":var d=a.getAttribute("data-startW"),e=a.offsetWidth;return a.setAttribute("data-prevW",e),d||a.setAttribute("data-startW",e),e;case"scaleY":var f=a.getAttribute("data-startH"),g=a.offsetHeight;return a.setAttribute("data-prevH",g),f||a.setAttribute("data-startH",g),g;case"opacity":return"getComputedStyle"in window?parseInt(window.getComputedStyle(a,null).getPropertyValue("opacity")):c>0?0:1}}function setPos(a,b,c){switch(b.attr){case"x":a.style.left=c+"px";break;case"y":a.style.top=c+"px";break;case"scaleX":a.style.width=c+"px";break;case"scaleY":a.style.height=c+"px";break;case"opacity":a.style.opacity=c,"filters"in a&&(a.filters.item("DXImageTransform.Microsoft.Alpha").opacity=100*c)}}function getTarg(a,b,c,d){return"x"==a||"y"==a||"opacity"==a?b-c:"scaleX"==a?b*d.getAttribute("data-startW")-c:"scaleY"==a?b*d.getAttribute("data-startH")-c:void 0}App.superTween=function(a,b,c){App.log(c),b=1e3*b,c.delay=1e3*c.delay,curAnims.push(setupTween(a,b,c)),easeGlobals.loopTimer||(easeGlobals.loopTimer=setTimeout(tweenLoop,easeGlobals.updateRate))};



/******************
 * EASES (only uncomment the ones you use)	
*******************/
var Expo = {
/*	easeIn: function(eVar) {
	   			return eVar.targVal * Math.pow(2, 10 * (eVar.curStep / eVar.animSteps - 1)) + eVar.origin;
			},		//*/	
/*	easeOut: function(eVar) {
	   			return eVar.targVal * (-Math.pow(2, -10 * eVar.curStep / eVar.animSteps) + 1) + eVar.origin;
			},		//*/
/*	easeInOut: function(eVar) {
		if ((eVar.curStep /= eVar.animSteps / 2) < 1) {
	        return eVar.targVal / 2 * Math.pow(2, 10 * (eVar.curStep - 1)) + eVar.origin;
	    }
	    return eVar.targVal / 2 * (-Math.pow(2, -10 * --eVar.curStep) + 2) + eVar.origin;

	},	// !NONFUNCTIONAL */
}
var Quint = {
/*	easeIn: function(eVar) {
	    		return eVar.targVal * Math.pow (eVar.curStep / eVar.animSteps, 5) + eVar.origin;
			},		//*/
/*	easeOut: function(eVar) {
	    		return eVar.targVal * (Math.pow(eVar.curStep / eVar.animSteps - 1, 5) + 1) + eVar.origin;
			},		//*/
/*	easeInOut: function(eVar) {
		if ((eVar.curStep /= eVar.animSteps / 2) < 1) {
	        return eVar.targVal / 2 * Math.pow(eVar.curStep, 5) + eVar.origin;
	    }
	    return eVar.targVal / 2 * (Math.pow(eVar.curStep - 2, 5) + 2) + eVar.origin;
	},	// !NONFUNCTIONAL */
}
var Quart = {
/*	easeIn: function(eVar) {
	    		return eVar.targVal * Math.pow (eVar.curStep / eVar.animSteps, 4) + eVar.origin;
			},		//*/
/*	easeOut: function(eVar) {
	    		return -eVar.targVal * (Math.pow(eVar.curStep / eVar.animSteps - 1, 4) - 1) + eVar.origin;
			},		//*/
/*	easeInOut: function(eVar) {
		if ((eVar.curStep /= eVar.animSteps / 2) < 1) {
	        return eVar.targVal / 2 * Math.pow(eVar.curStep, 4) + eVar.origin;
	    }
	    return -eVar.targVal / 2 * (Math.pow(eVar.curStep - 2, 4) - 2) + eVar.origin;
	},	// !NONFUNCTIONAL */
}
var Cubic = {
/*	easeIn: function(eVar) {
				return eVar.targVal * Math.pow(eVar.curStep / eVar.animSteps, 3) + eVar.origin;
			},		//*/
/*	easeOut: function(eVar) {
				return eVar.targVal * (Math.pow(eVar.curStep / eVar.animSteps - 1, 3) + 1) + eVar.origin;
			},		//*/
/*	easeInOut: function(eVar) {
		if ((eVar.curStep /= eVar.animSteps / 2) < 1) {
	        return eVar.targVal / 2 * Math.pow(eVar.curStep, 3) + eVar.origin;
	    }
	    return eVar.targVal / 2 * (Math.pow(eVar.curStep - 2, 3) + 2) + eVar.origin;
	},	// !NONFUNCTIONAL */
}
var Linear = {
/*	easeNone: function(eVar) {
			    return eVar.targVal * eVar.curStep / eVar.animSteps + eVar.origin;
			},		//*/
}
var Sine = {
/*	easeIn: function(eVar) {
			    return eVar.targVal * (1 - Math.cos(eVar.curStep / eVar.animSteps * (Math.PI / 2))) + eVar.origin;
			},		//*/
/*	easeOut: function(eVar) {
			    return eVar.targVal * Math.sin(eVar.curStep / eVar.animSteps * (Math.PI / 2)) + eVar.origin;
			},		//*/
	easeInOut: function(eVar) {
			    return eVar.targVal / 2 * (1 - Math.cos(Math.PI * eVar.curStep / eVar.animSteps)) + eVar.origin;
			},	//*/
}
var Elastic = {
/*	easeOut: function (eVar) {
				var a = 1;
				var p = 15;
				if (eVar.curStep==0) return eVar.origin;  if ((eVar.curStep/=eVar.animSteps)==1) return eVar.origin+eVar.targVal;  if (!p) p=eVar.animSteps*.3;
				if (a < Math.abs(eVar.targVal)) { a=eVar.targVal; var s=p/4; }
				else var s = p/(2*Math.PI) * Math.asin (eVar.targVal/a);
				return a*Math.pow(2,-10*eVar.curStep) * Math.sin( (eVar.curStep*eVar.animSteps-s)*(2*Math.PI)/p ) + eVar.targVal + eVar.origin;
			},		//*/
/*	easeIn: function (eVar) {
		var a = 1;
		var p = 15;
		if (eVar.curStep==0) return eVar.origin;  if ((eVar.curStep/=eVar.animSteps)==1) return eVar.origin+eVar.targVal;  if (!p) p=eVar.animSteps*.3;
		if (a < Math.abs(eVar.targVal)) { a=eVar.targVal; var s=p/4; }
		else var s = p/(2*Math.PI) * Math.asin (eVar.targVal/a);
		return -(a*Math.pow(2,10*(eVar.curStep-=1)) * Math.sin( (eVar.curStep*eVar.animSteps-s)*(2*Math.PI)/p )) + eVar.origin;
	},		//*/
	easeInOut: function (eVar) {
		var a = 1;
		var p = 15;
		if (eVar.curStep==0) return eVar.origin;  if ((eVar.curStep/=eVar.animSteps/2)==2) return eVar.origin+eVar.targVal;  if (!p) p=eVar.animSteps*(.3*1.5);
		if (a < Math.abs(eVar.targVal)) { a=eVar.targVal; var s=p/4; }
		else var s = p/(2*Math.PI) * Math.asin (eVar.targVal/a);
		if (eVar.curStep < 1) return -.5*(a*Math.pow(2,10*(eVar.curStep-=1)) * Math.sin( (eVar.curStep*eVar.animSteps-s)*(2*Math.PI)/p )) + eVar.origin;
		return a*Math.pow(2,-10*(eVar.curStep-=1)) * Math.sin( (eVar.curStep*eVar.animSteps-s)*(2*Math.PI)/p )*.5 + eVar.targVal + eVar.origin;
	}	//*/
}
var Back = {
	easeOut: function (eVar, s) {
				if (s == undefined) s = 1.70158;
				return eVar.targVal*((eVar.curStep=eVar.curStep/eVar.animSteps-1)*eVar.curStep*((s+1)*eVar.curStep + s) + 1) + eVar.origin;
			},	//*/
/*	easeIn: function (eVar, s) {
				if (s == undefined) s = 1.70158;
				return eVar.targVal*(eVar.curStep/=eVar.animSteps)*eVar.curStep*((s+1)*eVar.curStep - s) + eVar.origin;
			},	//*/
/*	easeInOut: function (eVar, s) {
				if (s == undefined) s = 1.70158; 
				if ((eVar.curStep/=eVar.animSteps/2) < 1) return eVar.targVal/2*(eVar.curStep*eVar.curStep*(((s*=(1.525))+1)*eVar.curStep - s)) + eVar.origin;
				return eVar.targVal/2*((eVar.curStep-=2)*eVar.curStep*(((s*=(1.525))+1)*eVar.curStep + s) + 2) + eVar.origin;
			}	//*/
}
var Bounce = {
/*	easeOut: function (eVar) {
						if ((eVar.curStep/=eVar.animSteps) < (1/2.75)) {
							return eVar.targVal*(7.5625*eVar.curStep*eVar.curStep) + eVar.curStep;
						} else if (eVar.curStep < (2/2.75)) {
							return eVar.targVal*(7.5625*(eVar.curStep-=(1.5/2.75))*eVar.curStep + .75) + eVar.curStep;
						} else if (eVar.curStep < (2.5/2.75)) {
							return eVar.targVal*(7.5625*(eVar.curStep-=(2.25/2.75))*eVar.curStep + .9375) + eVar.curStep;
						} else {
							return eVar.targVal*(7.5625*(eVar.curStep-=(2.625/2.75))*eVar.curStep + .984375) + eVar.curStep;
						}
				},		// !NONFUNCTIONAL */
/*	easeInOut: function (eVar) {
						var newVar2 = {curStep: eVar.curStep*2, origin: 0, targVal: eVar.targVal, animSteps: eVar.animSteps}
						if (eVar.curStep < eVar.animSteps/2) return Bounce.easeOut(newVar2) * .5 + eVar.curStep;
						var newVar = {curStep: eVar.curStep*2-eVar.animSteps, origin: 0, targVal: eVar.targVal, animSteps: eVar.animSteps};
						return Bounce.easeOut(newVar) * .5 + eVar.targVal*.5 + eVar.curStep;
				},	// !NONFUNCTIONAL */
/*	easeIn: function (eVar) {
						var newVar = {curStep: eVar.curStep-eVar.curStep, origin: 0, targVal: eVar.targVal, animSteps: eVar.animSteps}
						return eVar.targVal - Bounce.easeOut(newVar) + eVar.curStep;
				},		// !NONFUNCTIONAL */
}	// !NONFUNCTIONAL
var Quad = {
/*	easeIn: function(eVar) {
			    return eVar.targVal * (eVar.curStep /= eVar.animSteps) * eVar.curStep + eVar.origin;
			}		// !NONFUNCTIONAL */
/*	easeOut: function(eVar) {
			    return -eVar.targVal * (eVar.curStep /= eVar.animSteps) * (eVar.curStep - 2) + eVar.origin;
			}		// !NONFUNCTIONAL */
/*	easeInOut: function(eVar) {
			if ((eVar.curStep /= eVar.animSteps / 2) < 1) {
		        return eVar.targVal / 2 * eVar.curStep * eVar.curStep + eVar.origin;
		    }
			return -eVar.targVal / 2 * ((--eVar.curStep) * (eVar.curStep - 2) - 1) + eVar.origin;
			}		// !NONFUNCTIONAL */
}	// !NONFUNCTIONAL
var Circ = {
/*	easeIn: function(eVar) {
			    return eVar.targVal * (1 - Math.sqrt(1 - (eVar.curStep /= eVar.animSteps) * eVar.curStep)) + eVar.origin;
			}		// !NONFUNCTIONAL */
/*	easeOut: function(eVar) {
			    return eVar.targVal * Math.sqrt(1 - (eVar.curStep = eVar.curStep / eVar.animSteps - 1) * eVar.curStep) + eVar.origin;
			}		// !NONFUNCTIONAL */
/*	easeInOut: function(eVar) {
				if ((eVar.curStep /= eVar.animSteps / 2) < 1) {
			        return eVar.targVal / 2 * (1 - Math.sqrt(1 - eVar.curStep * eVar.curStep)) + eVar.origin;
			    }
			    return eVar.targVal / 2 * (Math.sqrt(1 - (eVar.curStep -= 2) * eVar.curStep) + 1) + eVar.origin;
		
			}		// !NONFUNCTIONAL */
}	// !NONFUNCTIONAL